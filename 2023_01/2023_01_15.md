# 2023_01_15 TIL

# Redux (React Library)

---

### 세 가지 경우의 상태(State의 이해)

#### Local State

데이터가 변경되어 하나의 컴포넌트에 속하는 UI에 영향을 미치는 상태.<br>
예를들어 사용자 입력을 보고 useState를 사용해서 그 입력과 함께 state 변수에 저장하거나 토글 버튼이 있다.

- useState 혹은 useReducer를 통해 로컬 상태 관리를 한다.

#### Cross-ComponentState

하나의 컴포넌트가 아니라 다수의 컴포넌트에 영향을 미치는 상태. 예를 들면 모달 오버레이를 열거나 닫는 버튼이 있다면 그런 모달 컴포넌트는 여러 컴포넌트에 영향을 미칠 수 있다. 이런 경우에는 props 체인을 구축해야 한다. prop 드릴링이라고도 한다. 로컬 상태보다 약간 복잡함.

- props 드릴링이나 props 체이닝 필요

#### App-Wide State

앱의 모든 컴포넌트에 영향을 미치는 상태. 사용자 인증 정보와 같은 것들이 이에 해당함.

- props 드릴링이나 props 체이닝 필요

---

Cross-Component State와 App-Wide State에서 데이터를 넣고 전체 props 함수를 업데이트 하는건 번거로울 수 있다.

**Q: React Context를 써서 애플리케이션의 상태관리를 할 수 있는데도 왜 Redux를 쓰는가?**

**A: React Context는 단점이 있다.<br>1. 복잡한 상태 로직을 관리할 때는 복잡해진다. 대형 프로젝트일 때 복잡성이 문제가 되는데 ContextProvider가 엄청 많아짐.<br>2. 테마변경 or 인증, 저빈도 업데이트는 좋지만 잦은 상태 변경은 성능 저하를 일으킨다.**

### Redux의 작동 방식

Redux는 우리의 애플리케이션에 있는 **하나의 중앙 데이터 저장소**이다. 여기서 데이터는 **상태**를 가리킨다.
정확히 한 개의 저장소를 갖는다. <br>그 저장소에 전체 애플리케이션의 모든 상태를 저장한다.

우리는 궁극적으로 그 저장소에 데이터를 저장해서 컴포넌트 안에서 그 데이터들을 사용할 수 있다. 상태가 변경되면 우리는 컴포넌트에서 그것을 인지하여 그에 맞춰 대응하고 UI를 업데이트하길 윈한다. 그러면 해당 컴포넌트는 중앙 저장소에 대한 구독을 설정한다.

컴포넌트가 저장소를 구독하고 데이터가 변경될 때마다 저장소가 컴포넌트에 알려주게 된다. 그러면 컴포넌트는 필요한 데이터를 받게 된다.(리덕스 저장소의 일부를 받게됨) 그리고 그걸 사용할 수 있게 된다.

### 데이터 변경 규칙

#### 컴포넌트는 절대로 저장된 데이터를 직접 조작하지 않는다. <br>그래서 구독을 하는 것이고 데이터는 절대로 반대 방향으로 흐르지 않는다.<br>그 대신에 우리는 Reducer라는 개념을 이용한다.

Reducer 함수라는게 있는데 우리는 이 Reducer 함수를 설정해야 한다. 이 함수는 변형을 담당한다.(저장된 데이터를 변경) 여기서 기억해야 할 점은 Reducer라는 용어가 useReducer처럼 들어본 것이지만 여기서 Reducer함수는 useReducer 훅과는 다르다. Reducer 함수는 입력을 받아서 그 입력을 변환하고 줄이는 함수이다.

#### 리덕스는 액션을 리듀서로 전달하고 원하는 작업에 대한 설명을 읽게된다. 그 작업을 리듀서가 수행하게 된다. 이렇게 컴포넌트가 액션을 발송(dispatch)하고 그 액션에는 수행해야 할 작업이 설명되어있지만 직접 하진 않는다. 액션들을 리듀서로 전달해서 그 액션이 원하는 걸 리듀서가 하게된다. 그리고 나서 리듀서는 새로운 상태를 뱉어내고 그게 실제로 중앙 데이터 저장소의 기존 상태를 대체하게 된다. 데이터 저장소의 상태가 업데이트 되면 구독중인 컴포넌트가 알림을 받게 되고 컴포넌트는 UI를 업데이트할 수 있다.
