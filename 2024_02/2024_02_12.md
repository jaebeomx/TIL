# 2024.02.12 TIL

## JavaScript

### ðŸš¨ ES6 (ES2015)ì˜ íŠ¹ì§•ë“¤

### â—ï¸í™”ì‚´í‘œ í•¨ìˆ˜(Arrow Function)

=>ë¡œ ì‚¬ìš©í•  ìˆ˜ ìžˆìœ¼ë©° í•¨ìˆ˜ì™€ ë‹¬ë¦¬ thisê°€ í•¨ìˆ˜ ìŠ¤ì½”í”„ì— ë°”ì¸ë”© ë˜ì§€ ì•Šê³  ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ë¥¼ ê°€ì§„ë‹¤. ì¦‰,
ìžì‹ ì„ ê°ì‹¸ëŠ” ì½”ë“œì™€ ë™ì¼í•œ thisë¥¼ ê³µìœ í•œë‹¤. ë˜í•œ í‘œí˜„ì‹ê³¼ ë¬¸ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.

```js
// í‘œí˜„ì‹(expression)
var odds = evens.map((v) => v + 1);
var nums = evens.map((v, i) => v + i);
var pairs = evens.map((v) => ({ even: v, odd: v + 1 }));

// ë¬¸(Statement)
nums.forEach((v) => {
  if (v % 5 === 0) fives.push(v);
});

// ë ‰ì‹œì»¬ this
var bob = {
  _name: "Bob",
  _friends: [],
  printFriends() {
    this._friends.forEach((f) => console.log(this._name + " knows " + f));
  },
};
```

---

### ðŸš¨ í´ëž˜ìŠ¤(Classes)

í”„ë¡œí† íƒ€ìž… ê¸°ë°˜ì˜ ê°ì²´ì§€í–¥ íŒ¨í„´ì„ ì‰½ê²Œ ë§Œë“  ìž¥ì¹˜ë¡œ, ìƒì†ê³¼ ìƒì„±ìž ë° ì¸ìŠ¤í„´ìŠ¤ì™€ ì •ì  ë©”ì„œë“œ ë“±ì„ ì§€ì›í•œë‹¤.

```js
class SkinnedMesh extends THREE.Mesh {
  constructor(geometry, materials) {
    super(geometry, materials);

    this.idMatrix = SkinnedMesh.defaultMatrix();
    this.bones = [];
    this.boneMatrices = [];
    //...
  }
  update(camera) {
    //...
    super.update();
  }
  get boneCount() {
    return this.bones.length;
  }
  set matrixType(matrixType) {
    this.idMatrix = SkinnedMesh[matrixType]();
  }
  static defaultMatrix() {
    return new THREE.Matrix4();
  }
}
```

---

### ðŸš¨ í…œí”Œë¦¿ ë¬¸ìžì—´(Template String)

ë³µìž¡í•œ ë¬¸ìžì—´ì„ ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ìž¥ì¹˜ë¡œ ë¬¸ìžì—´ ì•ˆì— ë¬¸ìžì—´ ë° ë³€ìˆ˜ë¥¼ ë„£ì„ ìˆ˜ ìžˆê³  ì—¬ëŸ¬ ì¤„ì˜ ë¬¸ìžì—´ì´ ê°€ëŠ¥í•˜ë‹¤.

```js
// ë¬¸ìžì—´ ì•ˆì— ë¬¸ìžì—´ ì‚¬ìš©í•˜ê¸°
`In JavaScript '\n' is a line-feed.` // ì—¬ëŸ¬ ì¤„ ë¬¸ìžì—´
`In JavaScript this is
 not legal.`;

// ë¬¸ìžì—´ ë³´ê°„(interpolation)
var name = "Bob",
  time = "today";
`Hello ${name}, how are you ${time}?`;
```

---

### ðŸš¨ ë¹„êµ¬ì¡°í™”(Destructuring)

ë°°ì—´ê³¼ ê°ì²´ì˜ íŒ¨í„´ ë§¤ì¹­ì„ í†µí•´ì„œ ë°”ì¸ë”©ì„ í•˜ëŠ” ê¸°ë²•ì´ë‹¤.

```js
// ë°°ì—´ ë§¤ì¹­
var [a, , b] = [1, 2, 3];

// ê°ì²´ ë§¤ì¹­
var {
  op: a,
  lhs: { op: b },
  rhs: c,
} = getASTNode();

// ê°ì²´ ë§¤ì¹­ì„ ë‹¨ì¶•í•´ì„œ ì‚¬ìš©
// op, lhs, rhsê°€ ìŠ¤ì½”í”„ ë‚´ì—ì„œ ë°”ì¸ë”©ë¨
var { op, lhs, rhs } = getASTNode();

// ë§¤ê°œë³€ìˆ˜ ìœ„ì¹˜ì—ë„ ì‚¬ìš© ê°€ëŠ¥
function g({ name: x }) {
  console.log(x);
}
g({ name: 5 });

// Fail-soft ë¹„êµ¬ì¡°í™” (Fail-softëŠ” ê³ ìž¥ì´ ë‚˜ë„ ìž‘ë™í•˜ë„ë¡ ì§  í”„ë¡œê·¸ëž¨ì„ ë§í•œë‹¤)
var [a] = [];
a === undefined;

// ê¸°ë³¸ ê°’ì´ ìžˆëŠ” Fail-soft ë¹„êµ¬ì¡°í™”
var [a = 1] = [];
a === 1;
```

---

### ðŸš¨ ê¸°ë³¸ê°’ + Rest + Spread

ê¸°ë³¸ê°’ì€ ì£¼ì–´ì§€ëŠ” ê°’ì´ ì—†ì„ ë•Œ ì´ˆê¸°í™” ì‹œí‚¤ëŠ” ê°’ì´ê³  rest ë¬¸ë²•ì€ ëª…ì‹œí•œ ë³€ìˆ˜ ì™¸ì— ë‚˜ë¨¸ì§€ë¥¼ ë°°ì—´ë¡œ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ë‹¤. Spread ë¬¸ë²•ì€ ë°°ì—´ì„ ë°˜ëŒ€ë¡œ íŽ¼ì¹˜ëŠ” ì—­í• ì´ë‹¤.

```js
function f(x, y = 12) {
  // yê°€ ì—†ê±°ë‚˜ undefinedì´ë©´ 12ì´ë‹¤.
  return x + y;
}
f(3) == 15;
```

```js
function f(x, ...y) {
  // yëŠ” ë°°ì—´ì´ë‹¤.
  return x * y.length;
}
f(3, "hello", true) == 6;
```

```js
function f(x, y, z) {
  return x + y + z;
}
// ê° ë°°ì—´ì˜ ì›ì†Œë¥¼ ì¸ìžë¡œ ë„˜ê¸´ë‹¤.
f(...[1, 2, 3]) == 6;
```

---

### ðŸš¨ëª¨ë“ˆ(Module)

#### â—ï¸importë¡œ ëª¨ë“ˆ ë¶ˆëŸ¬ì˜¤ê¸°

```js
// lib/math.js
export function sum(x, y) {
  return x + y;
}
export var pi = 3.141593;
```

```js
// app.js
import * as math from "lib/math";
alert("2Ï€ = " + math.sum(math.pi, math.pi));
```

```js
// otherApp.js
import { sum, pi } from "lib/math";
alert("2Ï€ = " + sum(pi, pi));
```

```js
// lib/mathplusplus.js
export * from "lib/math";
export var e = 2.71828182846;
export default function (x) {
  return Math.log(x);
}
```

---

### ðŸš¨Map + Set + WeakMap + WeakSet

ìžì£¼ ì“°ì´ëŠ” ìžë£Œêµ¬ì¡°ë¡œ, Weakì´ ë¶™ì€ ê²ƒì€ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì„ ì´ìš©í•˜ë©° size í”„ë¡œí¼í‹°ë¥¼ ê°€ì§€ì§€ ì•ŠëŠ”ë‹¤.

```js
// Sets
var s = new Set();
s.add("hello").add("goodbye").add("hello");
s.size === 2;
s.has("hello") === true;

// Maps
var m = new Map();
m.set("hello", 42);
m.set(s, 34);
m.get(s) == 34;

// Weak Maps
var wm = new WeakMap();
wm.set(s, { extra: 42 });
wm.size === undefined;

// Weak Sets
var ws = new WeakSet();
ws.add({ data: 42 });
// WeakSetì— ë“¤ì–´ê°„ ê°ì²´ê°€ ì–´ë– í•œ ì°¸ì¡°ë„ ê°€ì§€ì§€ ì•Šìœ¼ë¯€ë¡œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì´ ëœë‹¤.
```

---

### í”„ë¼ë¯¸ìŠ¤

```js
function timeout(duration = 0) {
  return new Promise((resolve, reject) => {
    setTimeout(resolve, duration);
  });
}

var p = timeout(1000)
  .then(() => {
    return timeout(2000);
  })
  .then(() => {
    throw new Error("hmm");
  })
  .catch((err) => {
    return Promise.all([timeout(100), timeout(200)]);
  });
```
